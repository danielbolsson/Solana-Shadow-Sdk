# Ghost Privacy - Ceremony Scripts

This directory contains scripts and guides for performing the trusted setup ceremony.

## Quick Start

To run a local test ceremony (simulates multi-party with automated contributions):

### Windows:
```cmd
run-ceremony.bat
```

### Linux/Mac:
```bash
chmod +x run-ceremony.sh
./run-ceremony.sh
```

This will:
1. Generate Powers of Tau parameters with multiple contributions
2. Create circuit-specific proving/verification keys
3. Apply random beacon
4. Verify all parameters
5. Copy keys to `circuits/build/` directory

**Time required:** ~5-10 minutes for 3 simulated participants

## Files

- **`run-ceremony.sh`** - Bash script for Unix/Linux/Mac
- **`run-ceremony.bat`** - Batch script for Windows
- **`CEREMONY_GUIDE.md`** - Complete step-by-step guide
  - Local test ceremony
  - Real multi-party ceremony
  - Participant instructions
  - Deployment guide

## For Production

For a real multi-party ceremony with independent participants, see:
- **`CEREMONY_GUIDE.md`** - Practical instructions
- **`../TRUSTED_SETUP.md`** - Detailed theory and best practices

## What Gets Generated

After running the ceremony:

```
scripts/ceremony/
├── pot20_final.ptau              # Powers of Tau parameters
├── transfer_final.zkey            # Transfer circuit proving key
├── transfer_verification_key.json # Transfer circuit VK
├── balance_final.zkey             # Balance circuit proving key
├── balance_verification_key.json  # Balance circuit VK
├── ring_sig_final.zkey            # Ring sig circuit proving key
└── ring_signature_verification_key.json # Ring sig circuit VK
```

Keys are automatically copied to `circuits/build/` if you choose.

## Next Steps After Ceremony

1. **Upload VKs to Solana:**
   ```bash
   cd ../privacy-integration
   npx ts-node store-verification-keys.ts
   ```

2. **Test with new keys:**
   ```bash
   cd ../privacy-integration
   npx ts-node privacy-sdk.ts
   ```

3. **Publish artifacts:**
   - Upload to IPFS
   - Create GitHub release
   - Update documentation with hashes

## Verification

Anyone can verify the ceremony outputs:

```bash
cd ceremony

# Verify Powers of Tau
snarkjs powersoftau verify pot20_final.ptau

# Verify each circuit
snarkjs zkey verify ../circuits/transfer.r1cs pot20_final.ptau transfer_final.zkey
snarkjs zkey verify ../circuits/balance.r1cs pot20_final.ptau balance_final.zkey
snarkjs zkey verify ../circuits/ring_signature.r1cs pot20_final.ptau ring_sig_final.zkey
```

All should output: `[OK] Valid Key`

## Security Note

**Test ceremony (automated):**
- Keys are generated by single computer
- Only suitable for development/testing
- **DO NOT USE IN PRODUCTION**

**Real multi-party ceremony:**
- Keys generated by multiple independent participants
- Secure if at least ONE participant is honest
- **Required for production deployment**

See `CEREMONY_GUIDE.md` for multi-party ceremony instructions.
